<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Survey + Map Picker</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: sans-serif;
    }
    #tripettoFrame {
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>
<body>
  <!-- ðŸ‘‡ Tripetto form embedded in an iframe -->
  <iframe id="tripettoFrame" src="https://tripetto.app/run/5K4PTLSPST"></iframe>

  <script>
    // Listen for message events from the map popup
    window.addEventListener("message", event => {
      if (event.data && event.data.lat && event.data.lng) {
        const { lat, lng } = event.data;
        console.log("Received coordinates:", lat, lng);

        // Reload Tripetto form with new lat/lng params
        const tripettoFormUrl = "https://tripetto.app/run/5K4PTLSPST";
        const iframe = document.getElementById("tripettoFrame");
        iframe.src = `${tripettoFormUrl}?lat=${lat}&lng=${lng}`;
      }
    });

    // Optional helper: open map popup (you can trigger this from a Tripetto button)
    window.openMapPopup = () => {
      const width = 600;
      const height = 500;
      const left = (screen.width - width) / 2;
      const top = (screen.height - height) / 2;
      window.open(
        "map.html", // ðŸ‘ˆ Separate file that holds the map picker
        "MapPicker",
        `width=${width},height=${height},left=${left},top=${top}`
      );
    };
  </script>
</body>
</html>
